<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Partidas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f7f7f7;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 14px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #45a049;
    }
    .resultado {
      display: none;
      margin-top: 10px;
      padding: 10px;
      border-radius: 10px;
      background-color: white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    .retangulo {
      width: 120px;
      height: 60px;
      color: white;
      font-size: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 10px;
    }
    .vermelho { background-color: #e53935; }
    .azul { background-color: #1e88e5; }
  </style>
</head>
<body>
  <h1>Partidas</h1>
  <table id="tabelaPartidas">
    <thead>
      <tr>
        <th>Rodada</th>
        <th>Vermelho 1</th>
        <th>Vermelho 2</th>
        <th>Azul 1</th>
        <th>Azul 2</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const endpoint = "https://script.google.com/macros/s/AKfycbzLih2c45N0fWtMR3tCkh2CVCUBCxHllYDgSjx9mbXHYUAxWn6PvFkVc8SFY-147ueUQw/exec";

    async function carregarPartidas() {
      const response = await fetch(endpoint);
      const dados = await response.json();

      // Agrupar por rodada
      const partidas = {};
      dados.forEach(linha => {
        const rodada = linha["Rodada"] || "-";
        const equipe = linha["Nome da Equipe"];
        const aliança = linha["Aliança"];
        const pontuacao = linha["Pontuação Total"] || 0;

        if (!partidas[rodada]) {
          partidas[rodada] = { Vermelho1: "-", Vermelho2: "-", Azul1: "-", Azul2: "-", Pontuacoes: {} };
        }

        partidas[rodada][aliança.replace(" ", "")] = equipe;
        partidas[rodada].Pontuacoes[equipe] = pontuacao;
      });

      const corpoTabela = document.querySelector("#tabelaPartidas tbody");
      corpoTabela.innerHTML = "";

      for (const rodada in partidas) {
        const p = partidas[rodada];
        const linha = document.createElement("tr");
        linha.innerHTML = `
          <td>${rodada}</td>
          <td>${p.Vermelho1}</td>
          <td>${p.Vermelho2}</td>
          <td>${p.Azul1}</td>
          <td>${p.Azul2}</td>
          <td><button onclick="mostrarResultado('${rodada}')">Ver Resultado</button></td>
        `;
        corpoTabela.appendChild(linha);

        const divResultado = document.createElement("div");
        divResultado.className = "resultado";
        divResultado.id = `resultado-${rodada}`;
        divResultado.innerHTML = `
          <div class="retangulo vermelho">${p.Pontuacoes[p.Vermelho1] || 0}</div>
          <div class="retangulo azul">${p.Pontuacoes[p.Azul1] || 0}</div>
        `;
        corpoTabela.appendChild(document.createElement("tr")).innerHTML = `<td colspan="6">${divResultado.outerHTML}</td>`;
      }
    }

    function mostrarResultado(rodada) {
      const div = document.getElementById(`resultado-${rodada}`);
      if (div.style.display === "flex") {
        div.style.display = "none";
      } else {
        div.style.display = "flex";
      }
    }

    carregarPartidas();
  </script>
</body>
</html>
