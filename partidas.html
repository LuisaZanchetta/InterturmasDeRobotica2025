<script>
const endpointRanking = "SEU_ENDPOINT_AQUI"; // endpoint da planilha (mesmo do ranking)

// Lista fixa das partidas
const partidas = [
  { rodada: 1, vermelho: "Br√°s Cubas", azul: "Dumount" },
  { rodada: 2, vermelho: "Fe Garay", azul: "Marta" },
  { rodada: 3, vermelho: "Capitu", azul: "Fe Garay" },
  { rodada: 4, vermelho: "Bras", azul: "Brentani" },
  { rodada: 5, vermelho: "Capitu", azul: "Marta" },
  { rodada: 6, vermelho: "Dumount", azul: "Brentani" },
  { rodada: 7, vermelho: "Brentani", azul: "Capitu" },
  { rodada: 8, vermelho: "Dumount", azul: "Fe Garay" },
  { rodada: 9, vermelho: "Marta", azul: "Dumount" },
  { rodada: 10, vermelho: "Fe Garay", azul: "Bras" },
  { rodada: 11, vermelho: "Marta", azul: "Capitu" },
  { rodada: 12, vermelho: "Bras", azul: "Brentani" }
];

const tbody = document.querySelector("#tabelaPartidas tbody");

// Preencher tabela com bot√µes
partidas.forEach((p, i) => {
  const linha = `
    <tr>
      <td>${p.rodada}</td>
      <td class="alianca-vermelha">${p.vermelho}</td>
      <td class="alianca-azul">${p.azul}</td>
      <td>
        <button class="btn btn-sm btn-secondary btn-resultado" data-index="${i}">
          Ver resultado
        </button>
      </td>
    </tr>
  `;
  tbody.insertAdjacentHTML("beforeend", linha);
});

// Ativar DataTable
$("#tabelaPartidas").DataTable({
  language: { url: "https://cdn.datatables.net/plug-ins/1.13.4/i18n/pt-BR.json" },
  pageLength: 6
});

// Fun√ß√£o para buscar as pontua√ß√µes consolidadas do ranking
fetch(endpointRanking)
  .then(res => res.json())
  .then(dados => {
    
    // üîπ Para cada bot√£o, configurar o clique
    document.querySelectorAll(".btn-resultado").forEach(btn => {
      btn.addEventListener("click", () => {
        const index = btn.getAttribute("data-index");
        const partida = partidas[index];

        // Procurar a pontua√ß√£o de cada equipe usando o ranking consolidado
        const vermelhoData = dados.find(
          e => e["Nome da Equipe"].trim() === partida.vermelho
               && parseInt(e["Rodadas"]) === partida.rodada
        );

        const azulData = dados.find(
          e => e["Nome da Equipe"].trim() === partida.azul
               && parseInt(e["Rodadas"]) === partida.rodada
        );

        const pontuacaoVermelho = vermelhoData ? vermelhoData["Pontua√ß√£o Total"] : "-";
        const pontuacaoAzul = azulData ? azulData["Pontua√ß√£o Total"] : "-";

        // Criar o box do resultado
        const box = document.createElement("div");
        box.classList.add("resultado-box");
        box.innerHTML = `
          <div class="resultado-vermelho">${partida.vermelho} ${pontuacaoVermelho}</div>
          <div class="resultado-azul">${partida.azul} ${pontuacaoAzul}</div>
        `;

        // Substituir o bot√£o pelo resultado
        btn.parentElement.innerHTML = "";
        btn.parentElement.appendChild(box);
      });
    });

  })
  .catch(err => console.error("Erro ao carregar dados do ranking:", err));
</script>
